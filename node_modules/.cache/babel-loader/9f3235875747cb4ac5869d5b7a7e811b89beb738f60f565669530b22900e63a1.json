{"ast":null,"code":"import _regeneratorRuntime from\"/Users/macintoshhd/Documents/Developpement/Web/Project/Shopify/Ecommerce-Shopify-master/frontend-shopify-ecommerce/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/macintoshhd/Documents/Developpement/Web/Project/Shopify/Ecommerce-Shopify-master/frontend-shopify-ecommerce/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/Users/macintoshhd/Documents/Developpement/Web/Project/Shopify/Ecommerce-Shopify-master/frontend-shopify-ecommerce/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/macintoshhd/Documents/Developpement/Web/Project/Shopify/Ecommerce-Shopify-master/frontend-shopify-ecommerce/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import React,{useRef,useState}from\"react\";import{useEffect}from\"react\";import{backend_url,server}from\"../../server\";import{useDispatch,useSelector}from\"react-redux\";import{useNavigate}from\"react-router-dom\";import{AiOutlineArrowRight,AiOutlineSend}from\"react-icons/ai\";import styles from\"../../styles/styles\";import{TfiGallery}from\"react-icons/tfi\";import socketIO from\"socket.io-client\";import{format}from\"timeago.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ENDPOINT=\"http://localhost:4000/\";var socketId=socketIO(ENDPOINT,{transports:[\"websocket\"]});var DashboardMessages=function DashboardMessages(){var _useSelector=useSelector(function(state){return state.seller;}),seller=_useSelector.seller;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),conversations=_useState2[0],setConversations=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),arrivalMessage=_useState4[0],setArrivalMessage=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),currentChat=_useState6[0],setCurrentChat=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),userData=_useState10[0],setUserData=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),newMessage=_useState12[0],setNewMessage=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),onlineUsers=_useState14[0],setOnlineUsers=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),images=_useState16[0],setImages=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),activeStatus=_useState18[0],setActiveStatus=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),open=_useState20[0],setOpen=_useState20[1];var scrollRef=useRef(null);useEffect(function(){socketId.on(\"getMessage\",function(data){setArrivalMessage({sender:data.senderId,text:data.text,createdAt:Date.now()});});},[]);useEffect(function(){arrivalMessage&&(currentChat===null||currentChat===void 0?void 0:currentChat.members.includes(arrivalMessage.sender))&&setMessages(function(prev){return[].concat(_toConsumableArray(prev),[arrivalMessage]);});},[arrivalMessage,currentChat]);useEffect(function(){var getConversation=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var resonse;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"\".concat(server,\"/conversation/get-all-conversation-seller/\").concat(seller===null||seller===void 0?void 0:seller._id),{withCredentials:true});case 3:resonse=_context.sent;setConversations(resonse.data.conversations);_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function getConversation(){return _ref.apply(this,arguments);};}();getConversation();},[seller,messages]);useEffect(function(){if(seller){var userId=seller===null||seller===void 0?void 0:seller._id;socketId.emit(\"addUser\",userId);socketId.on(\"getUsers\",function(data){setOnlineUsers(data);});}},[seller]);var onlineCheck=function onlineCheck(chat){var chatMembers=chat.members.find(function(member){return member!==(seller===null||seller===void 0?void 0:seller._id);});var online=onlineUsers.find(function(user){return user.userId===chatMembers;});return online?true:false;};// get messages\nuseEffect(function(){var getMessage=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.get(\"\".concat(server,\"/message/get-all-messages/\").concat(currentChat===null||currentChat===void 0?void 0:currentChat._id));case 3:response=_context2.sent;setMessages(response.data.messages);_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 10:case\"end\":return _context2.stop();}},_callee2,null,[[0,7]]);}));return function getMessage(){return _ref2.apply(this,arguments);};}();getMessage();},[currentChat]);// create new message\nvar sendMessageHandler=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e){var message,receiverId;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:e.preventDefault();message={sender:seller._id,text:newMessage,conversationId:currentChat._id};receiverId=currentChat.members.find(function(member){return member.id!==seller._id;});socketId.emit(\"sendMessage\",{senderId:seller._id,receiverId:receiverId,text:newMessage});_context3.prev=4;if(!(newMessage!==\"\")){_context3.next=8;break;}_context3.next=8;return axios.post(\"\".concat(server,\"/message/create-new-message\"),message).then(function(res){setMessages([].concat(_toConsumableArray(messages),[res.data.message]));updateLastMessage();}).catch(function(error){console.log(error);});case 8:_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](4);console.log(_context3.t0);case 13:case\"end\":return _context3.stop();}},_callee3,null,[[4,10]]);}));return function sendMessageHandler(_x){return _ref3.apply(this,arguments);};}();var updateLastMessage=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:socketId.emit(\"updateLastMessage\",{lastMessage:newMessage,lastMessageId:seller._id});_context4.next=3;return axios.put(\"\".concat(server,\"/conversation/update-last-message/\").concat(currentChat._id),{lastMessage:newMessage,lastMessageId:seller._id}).then(function(res){console.log(res.data.conversation);setNewMessage(\"\");}).catch(function(error){console.log(error);});case 3:case\"end\":return _context4.stop();}},_callee4);}));return function updateLastMessage(){return _ref4.apply(this,arguments);};}();// img upload\nvar handleImageUpload=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(e){var file;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:file=e.target.files[0];setImages(file);imageSendingHandler(file);case 3:case\"end\":return _context5.stop();}},_callee5);}));return function handleImageUpload(_x2){return _ref5.apply(this,arguments);};}();var imageSendingHandler=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(e){var formData,receiverId;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:formData=new FormData();formData.append(\"images\",e);formData.append(\"sender\",seller._id);formData.append(\"text\",newMessage);formData.append(\"conversationId\",currentChat._id);receiverId=currentChat.members.find(function(member){return member!==seller._id;});socketId.emit(\"sendMessage\",{senderId:seller._id,receiverId:receiverId,images:e});_context6.prev=7;_context6.next=10;return axios.post(\"\".concat(server,\"/message/create-new-message\"),formData,{headers:{\"Content-Type\":\"multipart/form-data\"}}).then(function(res){setImages();setMessages([].concat(_toConsumableArray(messages),[res.data.message]));updateLastMessageForImage();});case 10:_context6.next=15;break;case 12:_context6.prev=12;_context6.t0=_context6[\"catch\"](7);console.log(_context6.t0);case 15:case\"end\":return _context6.stop();}},_callee6,null,[[7,12]]);}));return function imageSendingHandler(_x3){return _ref6.apply(this,arguments);};}();var updateLastMessageForImage=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(){return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:_context7.next=2;return axios.put(\"\".concat(server,\"/conversation/update-last-message/\").concat(currentChat._id),{lastMessage:\"Photo\",lastMessageId:seller._id});case 2:case\"end\":return _context7.stop();}},_callee7);}));return function updateLastMessageForImage(){return _ref7.apply(this,arguments);};}();useEffect(function(){var _scrollRef$current;(_scrollRef$current=scrollRef.current)===null||_scrollRef$current===void 0?void 0:_scrollRef$current.scrollIntoView({beahaviour:\"smooth\"});},[messages]);return/*#__PURE__*/_jsxs(\"div\",{className:\"w-[90%] bg-white m-5 h-[85vh] overflow-y-scroll rounded\",children:[!open&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-center text-[30px] py-3 font-Poppins\",children:\"All Messages\"}),conversations&&conversations.map(function(item,index){return/*#__PURE__*/_jsx(MessageList,{data:item,index:index,setOpen:setOpen,setCurrentChat:setCurrentChat,me:seller._id,setUserData:setUserData,userData:userData,online:onlineCheck(item),setActiveStatus:setActiveStatus},index);})]}),open&&/*#__PURE__*/_jsx(SellerInbox,{setOpen:setOpen,newMessage:newMessage,setNewMessage:setNewMessage,sendMessageHandler:sendMessageHandler,messages:messages,sellerId:seller._id,userData:userData,activeStatus:activeStatus,scrollRef:scrollRef,setMessages:setMessages,handleImageUpload:handleImageUpload})]});};var MessageList=function MessageList(_ref8){var data=_ref8.data,index=_ref8.index,setOpen=_ref8.setOpen,setCurrentChat=_ref8.setCurrentChat,me=_ref8.me,setUserData=_ref8.setUserData,online=_ref8.online,setActiveStatus=_ref8.setActiveStatus;var _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),user=_useState22[0],setUser=_useState22[1];var navigate=useNavigate();var handleClick=function handleClick(id){navigate(\"/dashboard-messages?\".concat(id));setOpen(true);};var _useState23=useState(0),_useState24=_slicedToArray(_useState23,2),active=_useState24[0],setActive=_useState24[1];useEffect(function(){var userId=data.members.find(function(user){return user!=me;});var getUser=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(){var res;return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return axios.get(\"\".concat(server,\"/user/user-info/\").concat(userId));case 3:res=_context8.sent;setUser(res.data.user);_context8.next=10;break;case 7:_context8.prev=7;_context8.t0=_context8[\"catch\"](0);console.log(_context8.t0);case 10:case\"end\":return _context8.stop();}},_callee8,null,[[0,7]]);}));return function getUser(){return _ref9.apply(this,arguments);};}();getUser();},[me,data]);return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex p-3 px-3 \".concat(active===index?\"bg-[#00000010]\":\"bg-transparent\",\"  cursor-pointer\"),onClick:function onClick(e){return setActive(index)||handleClick(data._id)||setCurrentChat(data)||setUserData(user)||setActiveStatus(online);},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backend_url).concat(user===null||user===void 0?void 0:user.avatar),alt:\"\",className:\"w-[50px] h-[50px] rounded-full\"}),online?/*#__PURE__*/_jsx(\"div\",{className:\"w-[12px] h-[12px] bg-green-400 rounded-full absolute top-[2px] right-[2px]\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-[12px] h-[12px] bg-[#c7b9b9] rounded-full absolute top-[2px] right-[2px]\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pl-3\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-[18px]\",children:user===null||user===void 0?void 0:user.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-[16px] text-[#000c]\",children:[(data===null||data===void 0?void 0:data.lastMessageId)!==(user===null||user===void 0?void 0:user._id)?\"You:\":(user!==null&&user!==void 0&&user.name?user.name.split(\" \")[0]:\"\")+\": \",data===null||data===void 0?void 0:data.lastMessage]})]})]});};var SellerInbox=function SellerInbox(_ref10){var scrollRef=_ref10.scrollRef,setOpen=_ref10.setOpen,newMessage=_ref10.newMessage,setNewMessage=_ref10.setNewMessage,sendMessageHandler=_ref10.sendMessageHandler,messages=_ref10.messages,sellerId=_ref10.sellerId,userData=_ref10.userData,activeStatus=_ref10.activeStatus,handleImageUpload=_ref10.handleImageUpload;return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full min-h-full flex flex-col justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex p-3 items-center justify-between bg-slate-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backend_url).concat(userData===null||userData===void 0?void 0:userData.avatar),alt:\"\",className:\"w-[60px] h-[60px] rounded-full\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"pl-3\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-[18px] font-[600]\",children:userData===null||userData===void 0?void 0:userData.name}),/*#__PURE__*/_jsx(\"h1\",{children:activeStatus?\"Active Now\":\"\"})]})]}),/*#__PURE__*/_jsx(AiOutlineArrowRight,{size:20,className:\"cursor-pointer\",onClick:function onClick(){return setOpen(false);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"px-3 h-[65vh] py-3 overflow-y-scroll\",children:messages&&messages.map(function(item,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full my-2 \".concat(item.sender===sellerId?\"justify-end\":\"justify-start\"),ref:scrollRef,children:[item.sender!==sellerId&&/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backend_url).concat(userData===null||userData===void 0?void 0:userData.avatar),className:\"w-[40px] h-[40px] rounded-full mr-3\",alt:\"\"}),item.images&&/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backend_url).concat(item.images),className:\"w-[300px] h-[300px] object-cover rounded-[10px] mr-2\"}),item.text!==\"\"&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-max p-2 rounded \".concat(item.sender===sellerId?\"bg-[#000]\":\"bg-[#38c776]\",\" text-[#fff] h-min\"),children:/*#__PURE__*/_jsx(\"p\",{children:item.text})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[12px] text-[#000000d3] pt-1\",children:format(item.createdAt)})]})]});})}),/*#__PURE__*/_jsxs(\"form\",{\"aria-required\":true,className:\"p-3 relative w-full flex justify-between items-center\",onSubmit:sendMessageHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-[30px]\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"\",id:\"image\",className:\"hidden\",onChange:handleImageUpload}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"image\",children:/*#__PURE__*/_jsx(TfiGallery,{className:\"cursor-pointer\",size:20})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,placeholder:\"Enter your message...\",value:newMessage,onChange:function onChange(e){return setNewMessage(e.target.value);},className:\"\".concat(styles.input)}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Send\",className:\"hidden\",id:\"send\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"send\",children:/*#__PURE__*/_jsx(AiOutlineSend,{size:20,className:\"absolute right-4 top-5 cursor-pointer\"})})]})]})]});};export default DashboardMessages;","map":{"version":3,"names":["axios","React","useRef","useState","useEffect","backend_url","server","useDispatch","useSelector","useNavigate","AiOutlineArrowRight","AiOutlineSend","styles","TfiGallery","socketIO","format","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ENDPOINT","socketId","transports","DashboardMessages","_useSelector","state","seller","_useState","_useState2","_slicedToArray","conversations","setConversations","_useState3","_useState4","arrivalMessage","setArrivalMessage","_useState5","_useState6","currentChat","setCurrentChat","_useState7","_useState8","messages","setMessages","_useState9","_useState10","userData","setUserData","_useState11","_useState12","newMessage","setNewMessage","_useState13","_useState14","onlineUsers","setOnlineUsers","_useState15","_useState16","images","setImages","_useState17","_useState18","activeStatus","setActiveStatus","_useState19","_useState20","open","setOpen","scrollRef","on","data","sender","senderId","text","createdAt","Date","now","members","includes","prev","concat","_toConsumableArray","getConversation","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","resonse","wrap","_callee$","_context","next","get","_id","withCredentials","sent","t0","stop","apply","arguments","userId","emit","onlineCheck","chat","chatMembers","find","member","online","user","getMessage","_ref2","_callee2","response","_callee2$","_context2","console","log","sendMessageHandler","_ref3","_callee3","e","message","receiverId","_callee3$","_context3","preventDefault","conversationId","id","post","then","res","updateLastMessage","catch","error","_x","_ref4","_callee4","_callee4$","_context4","lastMessage","lastMessageId","put","conversation","handleImageUpload","_ref5","_callee5","file","_callee5$","_context5","target","files","imageSendingHandler","_x2","_ref6","_callee6","formData","_callee6$","_context6","FormData","append","headers","updateLastMessageForImage","_x3","_ref7","_callee7","_callee7$","_context7","_scrollRef$current","current","scrollIntoView","beahaviour","className","children","map","item","index","MessageList","me","SellerInbox","sellerId","_ref8","_useState21","_useState22","setUser","navigate","handleClick","_useState23","_useState24","active","setActive","getUser","_ref9","_callee8","_callee8$","_context8","onClick","src","avatar","alt","name","split","_ref10","size","ref","onSubmit","type","onChange","htmlFor","required","placeholder","value","input"],"sources":["/Users/macintoshhd/Documents/Developpement/Web/Project/Shopify/Ecommerce-Shopify-master/frontend-shopify-ecommerce/src/components/Shop/DashboardMessages.jsx"],"sourcesContent":["import axios from \"axios\";\nimport React, { useRef, useState } from \"react\";\nimport { useEffect } from \"react\";\nimport { backend_url, server } from \"../../server\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useNavigate } from \"react-router-dom\";\nimport { AiOutlineArrowRight, AiOutlineSend } from \"react-icons/ai\";\nimport styles from \"../../styles/styles\";\nimport { TfiGallery } from \"react-icons/tfi\";\nimport socketIO from \"socket.io-client\";\nimport { format } from \"timeago.js\";\nconst ENDPOINT = \"http://localhost:4000/\";\nconst socketId = socketIO(ENDPOINT, { transports: [\"websocket\"] });\n\nconst DashboardMessages = () => {\n  const { seller } = useSelector((state) => state.seller);\n  const [conversations, setConversations] = useState([]);\n  const [arrivalMessage, setArrivalMessage] = useState(null);\n  const [currentChat, setCurrentChat] = useState();\n  const [messages, setMessages] = useState([]);\n  const [userData, setUserData] = useState(null);\n  const [newMessage, setNewMessage] = useState(\"\");\n  const [onlineUsers, setOnlineUsers] = useState([]);\n  const [images, setImages] = useState();\n  const [activeStatus, setActiveStatus] = useState(false);\n  const [open, setOpen] = useState(false);\n  const scrollRef = useRef(null);\n\n  useEffect(() => {\n    socketId.on(\"getMessage\", (data) => {\n      setArrivalMessage({\n        sender: data.senderId,\n        text: data.text,\n        createdAt: Date.now(),\n      });\n    });\n  }, []);\n\n  useEffect(() => {\n    arrivalMessage &&\n      currentChat?.members.includes(arrivalMessage.sender) &&\n      setMessages((prev) => [...prev, arrivalMessage]);\n  }, [arrivalMessage, currentChat]);\n\n  useEffect(() => {\n    const getConversation = async () => {\n      try {\n        const resonse = await axios.get(\n          `${server}/conversation/get-all-conversation-seller/${seller?._id}`,\n          {\n            withCredentials: true,\n          }\n        );\n\n        setConversations(resonse.data.conversations);\n      } catch (error) {\n        // console.log(error);\n      }\n    };\n    getConversation();\n  }, [seller, messages]);\n\n  useEffect(() => {\n    if (seller) {\n      const userId = seller?._id;\n      socketId.emit(\"addUser\", userId);\n      socketId.on(\"getUsers\", (data) => {\n        setOnlineUsers(data);\n      });\n    }\n  }, [seller]);\n\n  const onlineCheck = (chat) => {\n    const chatMembers = chat.members.find((member) => member !== seller?._id);\n    const online = onlineUsers.find((user) => user.userId === chatMembers);\n\n    return online ? true : false;\n  };\n\n  // get messages\n  useEffect(() => {\n    const getMessage = async () => {\n      try {\n        const response = await axios.get(\n          `${server}/message/get-all-messages/${currentChat?._id}`\n        );\n        setMessages(response.data.messages);\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    getMessage();\n  }, [currentChat]);\n\n  // create new message\n  const sendMessageHandler = async (e) => {\n    e.preventDefault();\n\n    const message = {\n      sender: seller._id,\n      text: newMessage,\n      conversationId: currentChat._id,\n    };\n    const receiverId = currentChat.members.find(\n      (member) => member.id !== seller._id\n    );\n\n    socketId.emit(\"sendMessage\", {\n      senderId: seller._id,\n      receiverId,\n      text: newMessage,\n    });\n\n    try {\n      if (newMessage !== \"\") {\n        await axios\n          .post(`${server}/message/create-new-message`, message)\n          .then((res) => {\n            setMessages([...messages, res.data.message]);\n            updateLastMessage();\n          })\n          .catch((error) => {\n            console.log(error);\n          });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const updateLastMessage = async () => {\n    socketId.emit(\"updateLastMessage\", {\n      lastMessage: newMessage,\n      lastMessageId: seller._id,\n    });\n\n    await axios\n      .put(`${server}/conversation/update-last-message/${currentChat._id}`, {\n        lastMessage: newMessage,\n        lastMessageId: seller._id,\n      })\n      .then((res) => {\n        console.log(res.data.conversation);\n        setNewMessage(\"\");\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n\n  // img upload\n\n  const handleImageUpload = async (e) => {\n    const file = e.target.files[0];\n    setImages(file);\n    imageSendingHandler(file);\n  };\n\n  const imageSendingHandler = async (e) => {\n    const formData = new FormData();\n\n    formData.append(\"images\", e);\n    formData.append(\"sender\", seller._id);\n    formData.append(\"text\", newMessage);\n    formData.append(\"conversationId\", currentChat._id);\n\n    const receiverId = currentChat.members.find(\n      (member) => member !== seller._id\n    );\n\n    socketId.emit(\"sendMessage\", {\n      senderId: seller._id,\n      receiverId,\n      images: e,\n    });\n\n    try {\n      await axios\n        .post(`${server}/message/create-new-message`, formData, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\",\n          },\n        })\n        .then((res) => {\n          setImages();\n          setMessages([...messages, res.data.message]);\n          updateLastMessageForImage();\n        });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const updateLastMessageForImage = async () => {\n    await axios.put(\n      `${server}/conversation/update-last-message/${currentChat._id}`,\n      {\n        lastMessage: \"Photo\",\n        lastMessageId: seller._id,\n      }\n    );\n  };\n\n  useEffect(() => {\n    scrollRef.current?.scrollIntoView({ beahaviour: \"smooth\" });\n  }, [messages]);\n\n  return (\n    <div className=\"w-[90%] bg-white m-5 h-[85vh] overflow-y-scroll rounded\">\n      {!open && (\n        <>\n          <h1 className=\"text-center text-[30px] py-3 font-Poppins\">\n            All Messages\n          </h1>\n          {/* All messages list */}\n          {conversations &&\n            conversations.map((item, index) => (\n              <MessageList\n                data={item}\n                key={index}\n                index={index}\n                setOpen={setOpen}\n                setCurrentChat={setCurrentChat}\n                me={seller._id}\n                setUserData={setUserData}\n                userData={userData}\n                online={onlineCheck(item)}\n                setActiveStatus={setActiveStatus}\n              />\n            ))}\n        </>\n      )}\n\n      {open && (\n        <SellerInbox\n          setOpen={setOpen}\n          newMessage={newMessage}\n          setNewMessage={setNewMessage}\n          sendMessageHandler={sendMessageHandler}\n          messages={messages}\n          sellerId={seller._id}\n          userData={userData}\n          activeStatus={activeStatus}\n          scrollRef={scrollRef}\n          setMessages={setMessages}\n          handleImageUpload={handleImageUpload}\n        />\n      )}\n    </div>\n  );\n};\n\nconst MessageList = ({\n  data,\n  index,\n  setOpen,\n  setCurrentChat,\n  me,\n  setUserData,\n  online,\n  setActiveStatus,\n}) => {\n  const [user, setUser] = useState([]);\n  const navigate = useNavigate();\n  const handleClick = (id) => {\n    navigate(`/dashboard-messages?${id}`);\n    setOpen(true);\n  };\n  const [active, setActive] = useState(0);\n\n  useEffect(() => {\n    const userId = data.members.find((user) => user != me);\n\n    const getUser = async () => {\n      try {\n        const res = await axios.get(`${server}/user/user-info/${userId}`);\n        setUser(res.data.user);\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    getUser();\n  }, [me, data]);\n\n  return (\n    <div\n      className={`w-full flex p-3 px-3 ${\n        active === index ? \"bg-[#00000010]\" : \"bg-transparent\"\n      }  cursor-pointer`}\n      onClick={(e) =>\n        setActive(index) ||\n        handleClick(data._id) ||\n        setCurrentChat(data) ||\n        setUserData(user) ||\n        setActiveStatus(online)\n      }\n    >\n      <div className=\"relative\">\n        <img\n          src={`${backend_url}${user?.avatar}`}\n          alt=\"\"\n          className=\"w-[50px] h-[50px] rounded-full\"\n        />\n        {online ? (\n          <div className=\"w-[12px] h-[12px] bg-green-400 rounded-full absolute top-[2px] right-[2px]\" />\n        ) : (\n          <div className=\"w-[12px] h-[12px] bg-[#c7b9b9] rounded-full absolute top-[2px] right-[2px]\" />\n        )}\n      </div>\n      <div className=\"pl-3\">\n        <h1 className=\"text-[18px]\">{user?.name}</h1>\n        <p className=\"text-[16px] text-[#000c]\">\n          {data?.lastMessageId !== user?._id\n            ? \"You:\"\n            : (user?.name ? user.name.split(\" \")[0] : \"\") + \": \"}\n          {data?.lastMessage}\n        </p>\n      </div>\n    </div>\n  );\n};\n\nconst SellerInbox = ({\n  scrollRef,\n  setOpen,\n  newMessage,\n  setNewMessage,\n  sendMessageHandler,\n  messages,\n  sellerId,\n  userData,\n  activeStatus,\n  handleImageUpload,\n}) => {\n  return (\n    <div className=\"w-full min-h-full flex flex-col justify-between\">\n      {/* message header */}\n      <div className=\"w-full flex p-3 items-center justify-between bg-slate-200\">\n        <div className=\"flex\">\n          <img\n            src={`${backend_url}${userData?.avatar}`}\n            alt=\"\"\n            className=\"w-[60px] h-[60px] rounded-full\"\n          />\n          <div className=\"pl-3\">\n            <h1 className=\"text-[18px] font-[600]\">{userData?.name}</h1>\n            <h1>{activeStatus ? \"Active Now\" : \"\"}</h1>\n          </div>\n        </div>\n        <AiOutlineArrowRight\n          size={20}\n          className=\"cursor-pointer\"\n          onClick={() => setOpen(false)}\n        />\n      </div>\n\n      {/* messages */}\n      <div className=\"px-3 h-[65vh] py-3 overflow-y-scroll\">\n        {messages &&\n          messages.map((item, index) => {\n            return (\n              <div\n                className={`flex w-full my-2 ${\n                  item.sender === sellerId ? \"justify-end\" : \"justify-start\"\n                }`}\n                ref={scrollRef}\n              >\n                {item.sender !== sellerId && (\n                  <img\n                    src={`${backend_url}${userData?.avatar}`}\n                    className=\"w-[40px] h-[40px] rounded-full mr-3\"\n                    alt=\"\"\n                  />\n                )}\n\n                {item.images && (\n                  <img\n                    src={`${backend_url}${item.images}`}\n                    className=\"w-[300px] h-[300px] object-cover rounded-[10px] mr-2\"\n                  />\n                )}\n                {item.text !== \"\" && (\n                  <div>\n                    <div\n                      className={`w-max p-2 rounded ${\n                        item.sender === sellerId ? \"bg-[#000]\" : \"bg-[#38c776]\"\n                      } text-[#fff] h-min`}\n                    >\n                      <p>{item.text}</p>\n                    </div>\n\n                    <p className=\"text-[12px] text-[#000000d3] pt-1\">\n                      {format(item.createdAt)}\n                    </p>\n                  </div>\n                )}\n              </div>\n            );\n          })}\n      </div>\n\n      {/* send message input */}\n      <form\n        aria-required={true}\n        className=\"p-3 relative w-full flex justify-between items-center\"\n        onSubmit={sendMessageHandler}\n      >\n        <div className=\"w-[30px]\">\n          <input\n            type=\"file\"\n            name=\"\"\n            id=\"image\"\n            className=\"hidden\"\n            onChange={handleImageUpload}\n          />\n          <label htmlFor=\"image\">\n            <TfiGallery className=\"cursor-pointer\" size={20} />\n          </label>\n        </div>\n        <div className=\"w-full\">\n          <input\n            type=\"text\"\n            required\n            placeholder=\"Enter your message...\"\n            value={newMessage}\n            onChange={(e) => setNewMessage(e.target.value)}\n            className={`${styles.input}`}\n          />\n          <input type=\"submit\" value=\"Send\" className=\"hidden\" id=\"send\" />\n          <label htmlFor=\"send\">\n            <AiOutlineSend\n              size={20}\n              className=\"absolute right-4 top-5 cursor-pointer\"\n            />\n          </label>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default DashboardMessages;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}