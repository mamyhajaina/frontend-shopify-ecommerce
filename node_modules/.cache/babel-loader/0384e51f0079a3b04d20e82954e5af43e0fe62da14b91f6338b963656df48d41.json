{"ast":null,"code":"import _regeneratorRuntime from\"/Users/macintoshhd/Documents/Developpement/Web/Project/Shopify/Ecommerce-Shopify-master/frontend-shopify-ecommerce/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/macintoshhd/Documents/Developpement/Web/Project/Shopify/Ecommerce-Shopify-master/frontend-shopify-ecommerce/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/Users/macintoshhd/Documents/Developpement/Web/Project/Shopify/Ecommerce-Shopify-master/frontend-shopify-ecommerce/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/macintoshhd/Documents/Developpement/Web/Project/Shopify/Ecommerce-Shopify-master/frontend-shopify-ecommerce/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState}from\"react\";import Header from\"../components/Layout/Header\";import{useSelector}from\"react-redux\";import socketIO from\"socket.io-client\";import{format}from\"timeago.js\";import{backend_url,server}from\"../server\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{AiOutlineArrowRight,AiOutlineSend}from\"react-icons/ai\";import{TfiGallery}from\"react-icons/tfi\";import styles from\"../styles/styles\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ENDPOINT=\"http://localhost:4000/\";var socketId=socketIO(ENDPOINT,{transports:[\"websocket\"]});var UserInbox=function UserInbox(){var _useSelector=useSelector(function(state){return state.user;}),user=_useSelector.user;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),conversations=_useState2[0],setConversations=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),arrivalMessage=_useState4[0],setArrivalMessage=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),currentChat=_useState6[0],setCurrentChat=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),newMessage=_useState10[0],setNewMessage=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),userData=_useState12[0],setUserData=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),onlineUsers=_useState14[0],setOnlineUsers=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),images=_useState16[0],setImages=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),activeStatus=_useState18[0],setActiveStatus=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),open=_useState20[0],setOpen=_useState20[1];var scrollRef=useRef(null);useEffect(function(){socketId.on(\"getMessage\",function(data){setArrivalMessage({sender:data.senderId,text:data.text,createdAt:Date.now()});});},[]);useEffect(function(){arrivalMessage&&(currentChat===null||currentChat===void 0?void 0:currentChat.members.includes(arrivalMessage.sender))&&setMessages(function(prev){return[].concat(_toConsumableArray(prev),[arrivalMessage]);});},[arrivalMessage,currentChat]);useEffect(function(){var getConversation=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var resonse;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"\".concat(server,\"/conversation/get-all-conversation-user/\").concat(user===null||user===void 0?void 0:user._id),{withCredentials:true});case 3:resonse=_context.sent;setConversations(resonse.data.conversations);_context.next=9;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);case 9:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function getConversation(){return _ref.apply(this,arguments);};}();getConversation();},[user,messages]);useEffect(function(){if(user){var userId=user===null||user===void 0?void 0:user._id;socketId.emit(\"addUser\",userId);socketId.on(\"getUsers\",function(data){setOnlineUsers(data);});}},[user]);var onlineCheck=function onlineCheck(chat){var chatMembers=chat.members.find(function(member){return member!==(user===null||user===void 0?void 0:user._id);});var online=onlineUsers.find(function(user){return user.userId===chatMembers;});return online?true:false;};// get messages\nuseEffect(function(){var getMessage=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.get(\"\".concat(server,\"/message/get-all-messages/\").concat(currentChat===null||currentChat===void 0?void 0:currentChat._id));case 3:response=_context2.sent;setMessages(response.data.messages);_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 10:case\"end\":return _context2.stop();}},_callee2,null,[[0,7]]);}));return function getMessage(){return _ref2.apply(this,arguments);};}();getMessage();},[currentChat]);// create new message\nvar sendMessageHandler=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e){var message,receiverId;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:e.preventDefault();message={sender:user._id,text:newMessage,conversationId:currentChat._id};receiverId=currentChat.members.find(function(member){return member!==(user===null||user===void 0?void 0:user._id);});socketId.emit(\"sendMessage\",{senderId:user===null||user===void 0?void 0:user._id,receiverId:receiverId,text:newMessage});_context3.prev=4;if(!(newMessage!==\"\")){_context3.next=8;break;}_context3.next=8;return axios.post(\"\".concat(server,\"/message/create-new-message\"),message).then(function(res){setMessages([].concat(_toConsumableArray(messages),[res.data.message]));updateLastMessage();}).catch(function(error){console.log(error);});case 8:_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](4);console.log(_context3.t0);case 13:case\"end\":return _context3.stop();}},_callee3,null,[[4,10]]);}));return function sendMessageHandler(_x){return _ref3.apply(this,arguments);};}();var updateLastMessage=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:socketId.emit(\"updateLastMessage\",{lastMessage:newMessage,lastMessageId:user._id});_context4.next=3;return axios.put(\"\".concat(server,\"/conversation/update-last-message/\").concat(currentChat._id),{lastMessage:newMessage,lastMessageId:user._id}).then(function(res){setNewMessage(\"\");}).catch(function(error){console.log(error);});case 3:case\"end\":return _context4.stop();}},_callee4);}));return function updateLastMessage(){return _ref4.apply(this,arguments);};}();var handleImageUpload=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(e){var file;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:file=e.target.files[0];setImages(file);imageSendingHandler(file);case 3:case\"end\":return _context5.stop();}},_callee5);}));return function handleImageUpload(_x2){return _ref5.apply(this,arguments);};}();var imageSendingHandler=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(e){var formData,receiverId;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:formData=new FormData();formData.append(\"images\",e);formData.append(\"sender\",user._id);formData.append(\"text\",newMessage);formData.append(\"conversationId\",currentChat._id);receiverId=currentChat.members.find(function(member){return member!==user._id;});socketId.emit(\"sendMessage\",{senderId:user._id,receiverId:receiverId,images:e});_context6.prev=7;_context6.next=10;return axios.post(\"\".concat(server,\"/message/create-new-message\"),formData,{headers:{\"Content-Type\":\"multipart/form-data\"}}).then(function(res){setImages();setMessages([].concat(_toConsumableArray(messages),[res.data.message]));updateLastMessageForImage();});case 10:_context6.next=15;break;case 12:_context6.prev=12;_context6.t0=_context6[\"catch\"](7);console.log(_context6.t0);case 15:case\"end\":return _context6.stop();}},_callee6,null,[[7,12]]);}));return function imageSendingHandler(_x3){return _ref6.apply(this,arguments);};}();var updateLastMessageForImage=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(){return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:_context7.next=2;return axios.put(\"\".concat(server,\"/conversation/update-last-message/\").concat(currentChat._id),{lastMessage:\"Photo\",lastMessageId:user._id});case 2:case\"end\":return _context7.stop();}},_callee7);}));return function updateLastMessageForImage(){return _ref7.apply(this,arguments);};}();useEffect(function(){var _scrollRef$current;(_scrollRef$current=scrollRef.current)===null||_scrollRef$current===void 0?void 0:_scrollRef$current.scrollIntoView({beahaviour:\"smooth\"});},[messages]);return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full\",children:[!open&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-center text-[30px] py-3 font-Poppins\",children:\"All Messages\"}),conversations&&conversations.map(function(item,index){return/*#__PURE__*/_jsx(MessageList,{data:item,index:index,setOpen:setOpen,setCurrentChat:setCurrentChat,me:user===null||user===void 0?void 0:user._id,setUserData:setUserData,userData:userData,online:onlineCheck(item),setActiveStatus:setActiveStatus},index);})]}),open&&/*#__PURE__*/_jsx(SellerInbox,{setOpen:setOpen,newMessage:newMessage,setNewMessage:setNewMessage,sendMessageHandler:sendMessageHandler,messages:messages,sellerId:user._id,userData:userData,activeStatus:activeStatus,scrollRef:scrollRef,handleImageUpload:handleImageUpload})]});};var MessageList=function MessageList(_ref8){var data=_ref8.data,index=_ref8.index,setOpen=_ref8.setOpen,setCurrentChat=_ref8.setCurrentChat,me=_ref8.me,setUserData=_ref8.setUserData,userData=_ref8.userData,online=_ref8.online,setActiveStatus=_ref8.setActiveStatus;var _useState21=useState(0),_useState22=_slicedToArray(_useState21,2),active=_useState22[0],setActive=_useState22[1];var _useState23=useState([]),_useState24=_slicedToArray(_useState23,2),user=_useState24[0],setUser=_useState24[1];var navigate=useNavigate();var handleClick=function handleClick(id){navigate(\"/inbox?\".concat(id));setOpen(true);};useEffect(function(){setActiveStatus(online);var userId=data.members.find(function(user){return user!==me;});var getUser=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(){var res;return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return axios.get(\"\".concat(server,\"/shop/get-shop-info/\").concat(userId));case 3:res=_context8.sent;setUser(res.data.shop);_context8.next=10;break;case 7:_context8.prev=7;_context8.t0=_context8[\"catch\"](0);console.log(_context8.t0);case 10:case\"end\":return _context8.stop();}},_callee8,null,[[0,7]]);}));return function getUser(){return _ref9.apply(this,arguments);};}();getUser();},[me,data]);return/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex p-3 px-3 \".concat(active===index?\"bg-[#00000010]\":\"bg-transparent\",\"  cursor-pointer\"),onClick:function onClick(e){return setActive(index)||handleClick(data._id)||setCurrentChat(data)||setUserData(user)||setActiveStatus(online);},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backend_url).concat(userData===null||userData===void 0?void 0:userData.avatar),alt:\"\",className:\"w-[50px] h-[50px] rounded-full\"}),online?/*#__PURE__*/_jsx(\"div\",{className:\"w-[12px] h-[12px] bg-green-400 rounded-full absolute top-[2px] right-[2px]\"}):/*#__PURE__*/_jsx(\"div\",{className:\"w-[12px] h-[12px] bg-[#c7b9b9] rounded-full absolute top-[2px] right-[2px]\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pl-3\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-[18px]\",children:userData===null||userData===void 0?void 0:userData.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-[16px] text-[#000c]\",children:[(data===null||data===void 0?void 0:data.lastMessageId)!==(userData===null||userData===void 0?void 0:userData._id)?\"You:\":(userData===null||userData===void 0?void 0:userData.name.split(\" \")[0])+\": \",\" \",data===null||data===void 0?void 0:data.lastMessage]})]})]});};var SellerInbox=function SellerInbox(_ref10){var setOpen=_ref10.setOpen,newMessage=_ref10.newMessage,setNewMessage=_ref10.setNewMessage,sendMessageHandler=_ref10.sendMessageHandler,messages=_ref10.messages,sellerId=_ref10.sellerId,userData=_ref10.userData,activeStatus=_ref10.activeStatus,scrollRef=_ref10.scrollRef,handleImageUpload=_ref10.handleImageUpload;return/*#__PURE__*/_jsxs(\"div\",{className:\"w-[full] min-h-full flex flex-col justify-between p-5\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex p-3 items-center justify-between bg-slate-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backend_url).concat(userData===null||userData===void 0?void 0:userData.avatar),alt:\"\",className:\"w-[60px] h-[60px] rounded-full\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"pl-3\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-[18px] font-[600]\",children:userData===null||userData===void 0?void 0:userData.name}),/*#__PURE__*/_jsx(\"h1\",{children:activeStatus?\"Active Now\":\"\"})]})]}),/*#__PURE__*/_jsx(AiOutlineArrowRight,{size:20,className:\"cursor-pointer\",onClick:function onClick(){return setOpen(false);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"px-3 h-[75vh] py-3 overflow-y-scroll\",children:messages&&messages.map(function(item,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex w-full my-2 \".concat(item.sender===sellerId?\"justify-end\":\"justify-start\"),ref:scrollRef,children:[item.sender!==sellerId&&/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backend_url).concat(userData===null||userData===void 0?void 0:userData.avatar),className:\"w-[40px] h-[40px] rounded-full mr-3\",alt:\"\"}),item.images&&/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backend_url).concat(item.images),className:\"w-[300px] h-[300px] object-cover rounded-[10px] ml-2 mb-2\"}),item.text!==\"\"&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-max p-2 rounded \".concat(item.sender===sellerId?\"bg-[#000]\":\"bg-[#38c776]\",\" text-[#fff] h-min\"),children:/*#__PURE__*/_jsx(\"p\",{children:item.text})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-[12px] text-[#000000d3] pt-1\",children:format(item.createdAt)})]})]});})}),/*#__PURE__*/_jsxs(\"form\",{\"aria-required\":true,className:\"p-3 relative w-full flex justify-between items-center\",onSubmit:sendMessageHandler,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-[30px]\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"\",id:\"image\",className:\"hidden\",onChange:handleImageUpload}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"image\",children:/*#__PURE__*/_jsx(TfiGallery,{className:\"cursor-pointer\",size:20})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",required:true,placeholder:\"Enter your message...\",value:newMessage,onChange:function onChange(e){return setNewMessage(e.target.value);},className:\"\".concat(styles.input)}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Send\",className:\"hidden\",id:\"send\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"send\",children:/*#__PURE__*/_jsx(AiOutlineSend,{size:20,className:\"absolute right-4 top-5 cursor-pointer\"})})]})]})]});};export default UserInbox;","map":{"version":3,"names":["React","useEffect","useRef","useState","Header","useSelector","socketIO","format","backend_url","server","axios","useNavigate","AiOutlineArrowRight","AiOutlineSend","TfiGallery","styles","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ENDPOINT","socketId","transports","UserInbox","_useSelector","state","user","_useState","_useState2","_slicedToArray","conversations","setConversations","_useState3","_useState4","arrivalMessage","setArrivalMessage","_useState5","_useState6","currentChat","setCurrentChat","_useState7","_useState8","messages","setMessages","_useState9","_useState10","newMessage","setNewMessage","_useState11","_useState12","userData","setUserData","_useState13","_useState14","onlineUsers","setOnlineUsers","_useState15","_useState16","images","setImages","_useState17","_useState18","activeStatus","setActiveStatus","_useState19","_useState20","open","setOpen","scrollRef","on","data","sender","senderId","text","createdAt","Date","now","members","includes","prev","concat","_toConsumableArray","getConversation","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","resonse","wrap","_callee$","_context","next","get","_id","withCredentials","sent","t0","stop","apply","arguments","userId","emit","onlineCheck","chat","chatMembers","find","member","online","getMessage","_ref2","_callee2","response","_callee2$","_context2","console","log","sendMessageHandler","_ref3","_callee3","e","message","receiverId","_callee3$","_context3","preventDefault","conversationId","post","then","res","updateLastMessage","catch","error","_x","_ref4","_callee4","_callee4$","_context4","lastMessage","lastMessageId","put","handleImageUpload","_ref5","_callee5","file","_callee5$","_context5","target","files","imageSendingHandler","_x2","_ref6","_callee6","formData","_callee6$","_context6","FormData","append","headers","updateLastMessageForImage","_x3","_ref7","_callee7","_callee7$","_context7","_scrollRef$current","current","scrollIntoView","beahaviour","className","children","map","item","index","MessageList","me","SellerInbox","sellerId","_ref8","_useState21","_useState22","active","setActive","_useState23","_useState24","setUser","navigate","handleClick","id","getUser","_ref9","_callee8","_callee8$","_context8","shop","onClick","src","avatar","alt","name","split","_ref10","size","ref","onSubmit","type","onChange","htmlFor","required","placeholder","value","input"],"sources":["/Users/macintoshhd/Documents/Developpement/Web/Project/Shopify/Ecommerce-Shopify-master/frontend-shopify-ecommerce/src/pages/UserInbox.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport Header from \"../components/Layout/Header\";\nimport { useSelector } from \"react-redux\";\nimport socketIO from \"socket.io-client\";\nimport { format } from \"timeago.js\";\nimport { backend_url, server } from \"../server\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { AiOutlineArrowRight, AiOutlineSend } from \"react-icons/ai\";\nimport { TfiGallery } from \"react-icons/tfi\";\nimport styles from \"../styles/styles\";\nconst ENDPOINT = \"http://localhost:4000/\";\nconst socketId = socketIO(ENDPOINT, { transports: [\"websocket\"] });\n\nconst UserInbox = () => {\n  const { user } = useSelector((state) => state.user);\n  const [conversations, setConversations] = useState([]);\n  const [arrivalMessage, setArrivalMessage] = useState(null);\n  const [currentChat, setCurrentChat] = useState();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n  const [userData, setUserData] = useState(null);\n  const [onlineUsers, setOnlineUsers] = useState([]);\n  const [images, setImages] = useState();\n  const [activeStatus, setActiveStatus] = useState(false);\n  const [open, setOpen] = useState(false);\n  const scrollRef = useRef(null);\n\n  useEffect(() => {\n    socketId.on(\"getMessage\", (data) => {\n      setArrivalMessage({\n        sender: data.senderId,\n        text: data.text,\n        createdAt: Date.now(),\n      });\n    });\n  }, []);\n\n  useEffect(() => {\n    arrivalMessage &&\n      currentChat?.members.includes(arrivalMessage.sender) &&\n      setMessages((prev) => [...prev, arrivalMessage]);\n  }, [arrivalMessage, currentChat]);\n\n  useEffect(() => {\n    const getConversation = async () => {\n      try {\n        const resonse = await axios.get(\n          `${server}/conversation/get-all-conversation-user/${user?._id}`,\n          {\n            withCredentials: true,\n          }\n        );\n\n        setConversations(resonse.data.conversations);\n      } catch (error) {\n        // console.log(error);\n      }\n    };\n    getConversation();\n  }, [user, messages]);\n\n  useEffect(() => {\n    if (user) {\n      const userId = user?._id;\n      socketId.emit(\"addUser\", userId);\n      socketId.on(\"getUsers\", (data) => {\n        setOnlineUsers(data);\n      });\n    }\n  }, [user]);\n\n  const onlineCheck = (chat) => {\n    const chatMembers = chat.members.find((member) => member !== user?._id);\n    const online = onlineUsers.find((user) => user.userId === chatMembers);\n\n    return online ? true : false;\n  };\n\n  // get messages\n  useEffect(() => {\n    const getMessage = async () => {\n      try {\n        const response = await axios.get(\n          `${server}/message/get-all-messages/${currentChat?._id}`\n        );\n        setMessages(response.data.messages);\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    getMessage();\n  }, [currentChat]);\n\n  // create new message\n  const sendMessageHandler = async (e) => {\n    e.preventDefault();\n\n    const message = {\n      sender: user._id,\n      text: newMessage,\n      conversationId: currentChat._id,\n    };\n    const receiverId = currentChat.members.find(\n      (member) => member !== user?._id\n    );\n\n    socketId.emit(\"sendMessage\", {\n      senderId: user?._id,\n      receiverId,\n      text: newMessage,\n    });\n\n    try {\n      if (newMessage !== \"\") {\n        await axios\n          .post(`${server}/message/create-new-message`, message)\n          .then((res) => {\n            setMessages([...messages, res.data.message]);\n            updateLastMessage();\n          })\n          .catch((error) => {\n            console.log(error);\n          });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const updateLastMessage = async () => {\n    socketId.emit(\"updateLastMessage\", {\n      lastMessage: newMessage,\n      lastMessageId: user._id,\n    });\n\n    await axios\n      .put(`${server}/conversation/update-last-message/${currentChat._id}`, {\n        lastMessage: newMessage,\n        lastMessageId: user._id,\n      })\n      .then((res) => {\n        setNewMessage(\"\");\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n\n  const handleImageUpload = async (e) => {\n    const file = e.target.files[0];\n    setImages(file);\n    imageSendingHandler(file);\n  };\n\n  const imageSendingHandler = async (e) => {\n    const formData = new FormData();\n\n    formData.append(\"images\", e);\n    formData.append(\"sender\", user._id);\n    formData.append(\"text\", newMessage);\n    formData.append(\"conversationId\", currentChat._id);\n\n    const receiverId = currentChat.members.find(\n      (member) => member !== user._id\n    );\n\n    socketId.emit(\"sendMessage\", {\n      senderId: user._id,\n      receiverId,\n      images: e,\n    });\n\n    try {\n      await axios\n        .post(`${server}/message/create-new-message`, formData, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\",\n          },\n        })\n        .then((res) => {\n          setImages();\n          setMessages([...messages, res.data.message]);\n          updateLastMessageForImage();\n        });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const updateLastMessageForImage = async () => {\n    await axios.put(\n      `${server}/conversation/update-last-message/${currentChat._id}`,\n      {\n        lastMessage: \"Photo\",\n        lastMessageId: user._id,\n      }\n    );\n  };\n\n  useEffect(() => {\n    scrollRef.current?.scrollIntoView({ beahaviour: \"smooth\" });\n  }, [messages]);\n\n  return (\n    <div className=\"w-full\">\n      {!open && (\n        <>\n          <Header />\n          <h1 className=\"text-center text-[30px] py-3 font-Poppins\">\n            All Messages\n          </h1>\n          {/* All messages list */}\n          {conversations &&\n            conversations.map((item, index) => (\n              <MessageList\n                data={item}\n                key={index}\n                index={index}\n                setOpen={setOpen}\n                setCurrentChat={setCurrentChat}\n                me={user?._id}\n                setUserData={setUserData}\n                userData={userData}\n                online={onlineCheck(item)}\n                setActiveStatus={setActiveStatus}\n              />\n            ))}\n        </>\n      )}\n\n      {open && (\n        <SellerInbox\n          setOpen={setOpen}\n          newMessage={newMessage}\n          setNewMessage={setNewMessage}\n          sendMessageHandler={sendMessageHandler}\n          messages={messages}\n          sellerId={user._id}\n          userData={userData}\n          activeStatus={activeStatus}\n          scrollRef={scrollRef}\n          handleImageUpload={handleImageUpload}\n        />\n      )}\n    </div>\n  );\n};\n\nconst MessageList = ({\n  data,\n  index,\n  setOpen,\n  setCurrentChat,\n  me,\n  setUserData,\n  userData,\n  online,\n  setActiveStatus,\n}) => {\n  const [active, setActive] = useState(0);\n  const [user, setUser] = useState([]);\n  const navigate = useNavigate();\n  const handleClick = (id) => {\n    navigate(`/inbox?${id}`);\n    setOpen(true);\n  };\n\n  useEffect(() => {\n    setActiveStatus(online);\n    const userId = data.members.find((user) => user !== me);\n    const getUser = async () => {\n      try {\n        const res = await axios.get(`${server}/shop/get-shop-info/${userId}`);\n\n        setUser(res.data.shop);\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    getUser();\n  }, [me, data]);\n\n  return (\n    <div\n      className={`w-full flex p-3 px-3 ${\n        active === index ? \"bg-[#00000010]\" : \"bg-transparent\"\n      }  cursor-pointer`}\n      onClick={(e) =>\n        setActive(index) ||\n        handleClick(data._id) ||\n        setCurrentChat(data) ||\n        setUserData(user) ||\n        setActiveStatus(online)\n      }\n    >\n      <div className=\"relative\">\n        <img\n          src={`${backend_url}${userData?.avatar}`}\n          alt=\"\"\n          className=\"w-[50px] h-[50px] rounded-full\"\n        />\n        {online ? (\n          <div className=\"w-[12px] h-[12px] bg-green-400 rounded-full absolute top-[2px] right-[2px]\" />\n        ) : (\n          <div className=\"w-[12px] h-[12px] bg-[#c7b9b9] rounded-full absolute top-[2px] right-[2px]\" />\n        )}\n      </div>\n      <div className=\"pl-3\">\n        <h1 className=\"text-[18px]\">{userData?.name}</h1>\n        <p className=\"text-[16px] text-[#000c]\">\n          {data?.lastMessageId !== userData?._id\n            ? \"You:\"\n            : userData?.name.split(\" \")[0] + \": \"}{\" \"}\n          {data?.lastMessage}\n        </p>\n      </div>\n    </div>\n  );\n};\n\nconst SellerInbox = ({\n  setOpen,\n  newMessage,\n  setNewMessage,\n  sendMessageHandler,\n  messages,\n  sellerId,\n  userData,\n  activeStatus,\n  scrollRef,\n  handleImageUpload,\n}) => {\n  return (\n    <div className=\"w-[full] min-h-full flex flex-col justify-between p-5\">\n      {/* message header */}\n      <div className=\"w-full flex p-3 items-center justify-between bg-slate-200\">\n        <div className=\"flex\">\n          <img\n            src={`${backend_url}${userData?.avatar}`}\n            alt=\"\"\n            className=\"w-[60px] h-[60px] rounded-full\"\n          />\n          <div className=\"pl-3\">\n            <h1 className=\"text-[18px] font-[600]\">{userData?.name}</h1>\n            <h1>{activeStatus ? \"Active Now\" : \"\"}</h1>\n          </div>\n        </div>\n        <AiOutlineArrowRight\n          size={20}\n          className=\"cursor-pointer\"\n          onClick={() => setOpen(false)}\n        />\n      </div>\n\n      {/* messages */}\n      <div className=\"px-3 h-[75vh] py-3 overflow-y-scroll\">\n        {messages &&\n          messages.map((item, index) => (\n            <div\n              className={`flex w-full my-2 ${\n                item.sender === sellerId ? \"justify-end\" : \"justify-start\"\n              }`}\n              ref={scrollRef}\n            >\n              {item.sender !== sellerId && (\n                <img\n                  src={`${backend_url}${userData?.avatar}`}\n                  className=\"w-[40px] h-[40px] rounded-full mr-3\"\n                  alt=\"\"\n                />\n              )}\n              {item.images && (\n                <img\n                  src={`${backend_url}${item.images}`}\n                  className=\"w-[300px] h-[300px] object-cover rounded-[10px] ml-2 mb-2\"\n                />\n              )}\n              {item.text !== \"\" && (\n                <div>\n                  <div\n                    className={`w-max p-2 rounded ${\n                      item.sender === sellerId ? \"bg-[#000]\" : \"bg-[#38c776]\"\n                    } text-[#fff] h-min`}\n                  >\n                    <p>{item.text}</p>\n                  </div>\n\n                  <p className=\"text-[12px] text-[#000000d3] pt-1\">\n                    {format(item.createdAt)}\n                  </p>\n                </div>\n              )}\n            </div>\n          ))}\n      </div>\n\n      {/* send message input */}\n      <form\n        aria-required={true}\n        className=\"p-3 relative w-full flex justify-between items-center\"\n        onSubmit={sendMessageHandler}\n      >\n        <div className=\"w-[30px]\">\n          <input\n            type=\"file\"\n            name=\"\"\n            id=\"image\"\n            className=\"hidden\"\n            onChange={handleImageUpload}\n          />\n          <label htmlFor=\"image\">\n            <TfiGallery className=\"cursor-pointer\" size={20} />\n          </label>\n        </div>\n        <div className=\"w-full\">\n          <input\n            type=\"text\"\n            required\n            placeholder=\"Enter your message...\"\n            value={newMessage}\n            onChange={(e) => setNewMessage(e.target.value)}\n            className={`${styles.input}`}\n          />\n          <input type=\"submit\" value=\"Send\" className=\"hidden\" id=\"send\" />\n          <label htmlFor=\"send\">\n            <AiOutlineSend\n              size={20}\n              className=\"absolute right-4 top-5 cursor-pointer\"\n            />\n          </label>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default UserInbox;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}